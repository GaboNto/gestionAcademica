import{a as V}from"./chunk-HTL4VUFL.js";import{a as A}from"./chunk-MYRCIDBR.js";import{a as L}from"./chunk-6KCNCCZ5.js";import{d as R,i as z}from"./chunk-MPN7ZU5M.js";import{a as T,h as F}from"./chunk-E3JY4AQ7.js";import{Bb as o,Cb as m,Da as r,Db as d,Oa as O,Ta as h,_ as u,_a as P,db as _,fa as f,ga as x,gb as C,hb as v,ib as i,ic as I,jb as n,kb as E,ob as b,oc as w,pc as M,qb as y,rb as g,sd as D,wa as S,wd as k}from"./chunk-JHWQBVSM.js";import"./chunk-TSRGIXR5.js";var G=(a,t)=>t.title;function N(a,t){if(a&1&&(i(0,"p"),o(1),n()),a&2){let e=g().$implicit;r(),m(e.desc)}}function $(a,t){if(a&1){let e=b();i(0,"button",27),y("click",function(c){let l=f(e).$implicit,p=g(3);return c.stopPropagation(),x(p.go(l.route))}),o(1),n()}if(a&2){let e=t.$implicit;r(),d(" ",e.title," ")}}function U(a,t){if(a&1&&(i(0,"div",25),C(1,$,2,1,"button",26,G),n()),a&2){let e=g().$implicit;r(),v(e.subItems)}}function H(a,t){if(a&1){let e=b();i(0,"mat-card",21),y("click",function(){let c=f(e).$implicit,l=g();return x(l.go(c.route))}),i(1,"div",22)(2,"div",23)(3,"span",4),o(4),n()(),i(5,"div",24)(6,"h3"),o(7),n(),h(8,N,2,1,"p"),n()(),h(9,U,3,0,"div",25),n()}if(a&2){let e=t.$implicit;r(4),m(e.icon),r(3),m(e.title),r(),_(e.desc?8:-1),r(),_(e.subItems!=null&&e.subItems.length?9:-1)}}var j=class a{router=u(R);platformId=u(S);centrosService=u(L);estudiantesService=u(V);encuestasService=u(A);themeClass="light-theme";user={name:"Usuario",roleLabel:"Rol",icon:"account_circle"};cards=[];lastLogin=null;summary={estudiantes:null,centros:null,encuestas:null};ngOnInit(){if(!M(this.platformId))return;let t=localStorage.getItem("app.selectedRole"),e=t?JSON.parse(t):null;e?(this.user={name:e.name,roleLabel:this.mapRoleLabel(e.id),icon:e.icon??"account_circle"},this.cards=this.buildCardsFor(e.id)):this.cards=this.buildCardsFor("vinculacion");let s=localStorage.getItem("lastLogin");if(s){let c=new Date(s);this.lastLogin=c.toLocaleString("es-CL",{dateStyle:"medium",timeStyle:"short"})}else this.lastLogin=null;this.loadSummary()}mapRoleLabel(t){switch(t){case"jefatura":return"Jefatura de Carrera";case"vinculacion":return"Coordinador(a) de Vinculaci\xF3n";case"practicas":return"Coordinador(a) de Pr\xE1cticas"}}buildCardsFor(t){let e=[];return t==="jefatura"?[{title:"Usuarios",icon:"manage_accounts",route:"/usuarios",desc:"Roles y permisos"},{title:"Estudiantes en pr\xE1ctica",icon:"school",route:"/estudiantes-en-practica",desc:"Visualizaci\xF3n de estudiantes en pr\xE1ctica"},{title:"Tutores",icon:"supervisor_account",route:"/tutores",desc:"Visualizaci\xF3n de tutores"},{title:"Colaboradores",icon:"groups",route:"/colaboradores",desc:"Visualizaci\xF3n de colaboradores"},{title:"Actividades",icon:"assignment",route:"/actividades-estudiantes",desc:"Visualizaci\xF3n de actividades"},{title:"Supervisi\xF3n general",icon:"insights",route:"/supervision",desc:"Indicadores y seguimiento"},{title:"Reportes completos",icon:"analytics",route:"/reportes",desc:"Reportes y estad\xEDsticas"},{title:"Generar solicitud",icon:"description",route:"/carta",desc:"Generar cartas de presentaci\xF3n"},...e]:t==="vinculacion"?[{title:"Centros educativos",icon:"domain",route:"/centros-educativos",desc:"Listado de centros educativos"},{title:"Colaboradores",icon:"groups",route:"/colaboradores",desc:"Gesti\xF3n de colaboradores"},{title:"Estudiantes",icon:"school",route:"/estudiantes",desc:"Seguimiento de estudiantes"},{title:"Encuestas",icon:"assignment",route:"/encuestas",desc:"Registro y an\xE1lisis de encuestas"},...e]:t==="practicas"?[{title:"Estudiantes",icon:"school",route:"/estudiantes",desc:"Seguimiento asignado"},{title:"Tutores",icon:"supervisor_account",route:"/tutores",desc:"Gesti\xF3n de tutores"},{title:"Centros educativos",icon:"domain",route:"/centros-educativos",desc:"Gesti\xF3n de centros"},{title:"Pr\xE1cticas",icon:"event_note",route:"/practicas",desc:"Gesti\xF3n de pr\xE1cticas"},{title:"Colaboradores",icon:"groups",route:"/colaboradores",desc:"Gesti\xF3n de colaboradores"},{title:"Reportes/Historial",icon:"timeline",route:"/reportes",desc:"Historial y reportes"},...e]:[{title:"Encuestas",icon:"assignment",route:"/encuestas",desc:"Responde tus formularios"},...e]}loadSummary(){M(this.platformId)&&(this.centrosService.list({page:1,limit:1}).subscribe({next:t=>{this.summary.centros=(t&&typeof t.total=="number"?t.total:t?.items?.length??0)||0},error:()=>{this.summary.centros=null}}),this.estudiantesService.listar().subscribe({next:t=>{this.summary.estudiantes=t?.length??0},error:()=>{this.summary.estudiantes=null}}),this.encuestasService.getEncuestasRegistradas().subscribe({next:t=>{this.summary.encuestas=t?.length??0},error:()=>{this.summary.encuestas=null}}))}go(t){this.router.navigate([t])}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=O({type:a,selectors:[["app-dashboard"]],decls:52,vars:8,consts:[[1,"dashboard",3,"ngClass"],[1,"hero"],[1,"hero-main"],[1,"hero-icon"],[1,"material-icons"],[1,"hero-texts"],[1,"hero-role"],[1,"hero-side"],[1,"hero-pill"],[1,"dot"],[1,"hero-env"],[1,"summary-row"],[1,"summary-card","elev"],[1,"summary-label"],[1,"summary-value"],[1,"summary-foot"],[1,"page"],[1,"modules-section"],[1,"modules-header"],[1,"modules-grid"],[1,"module-card","elev"],[1,"module-card","elev",3,"click"],[1,"module-header"],[1,"module-icon"],[1,"module-title"],[1,"module-subitems"],["type","button",1,"sub-chip"],["type","button",1,"sub-chip",3,"click"]],template:function(e,s){if(e&1&&(i(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3)(4,"span",4),o(5),n()(),i(6,"div",5)(7,"h1"),o(8),n(),i(9,"p"),o(10," Est\xE1s gestionando el sistema como "),i(11,"span",6),o(12),n(),o(13,". "),n()()(),i(14,"div",7)(15,"div",8),E(16,"span",9),o(17," Sesi\xF3n activa "),n(),i(18,"div",10),o(19),n()()(),i(20,"section",11)(21,"mat-card",12)(22,"div",13),o(23,"ESTUDIANTES"),n(),i(24,"div",14),o(25),n(),i(26,"div",15),o(27,"Matriculados en pr\xE1ctica"),n()(),i(28,"mat-card",12)(29,"div",13),o(30,"CENTROS"),n(),i(31,"div",14),o(32),n(),i(33,"div",15),o(34,"Centros educativos vinculados"),n()(),i(35,"mat-card",12)(36,"div",13),o(37,"ENCUESTAS"),n(),i(38,"div",14),o(39),n(),i(40,"div",15),o(41,"Respuestas registradas"),n()()(),i(42,"section",16)(43,"section",17)(44,"div",18)(45,"h2"),o(46,"M\xF3dulos del sistema"),n(),i(47,"p"),o(48,"Selecciona un m\xF3dulo para acceder a sus funciones."),n()(),i(49,"div",19),C(50,H,10,4,"mat-card",20,G),n()()()()),e&2){let c,l,p;P("ngClass",s.themeClass),r(5),m(s.user.icon),r(3),d("Hola, ",s.user.name,""),r(4),m(s.user.roleLabel),r(7),d(" \xDAltimo acceso: ",s.lastLogin||"\u2014"," "),r(6),d(" ",(c=s.summary.estudiantes)!==null&&c!==void 0?c:"\u2014"," "),r(7),d(" ",(l=s.summary.centros)!==null&&l!==void 0?l:"\u2014"," "),r(7),d(" ",(p=s.summary.encuestas)!==null&&p!==void 0?p:"\u2014"," "),r(11),v(s.cards)}},dependencies:[w,I,z,k,D,F,T],styles:[".dashboard[_ngcontent-%COMP%]{padding:20px 20px 32px;display:flex;flex-direction:column;gap:20px}.hero[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:16px 18px;border-radius:16px;background:linear-gradient(120deg,#1d4ed8,#4f46e5);color:#e5e7eb}.hero-main[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px}.hero-icon[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:16px;display:flex;align-items:center;justify-content:center;background:#0f172a4d;font-size:30px}.hero-texts[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.4rem;font-weight:600}.hero-texts[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0 0;font-size:.9rem;color:#e5e7eb}.hero-role[_ngcontent-%COMP%]{font-weight:600}.hero-side[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:6px;font-size:.78rem}.hero-pill[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;background:#0f172a66}.hero-pill[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:7px;height:7px;border-radius:999px;background:#22c55e}.hero-env[_ngcontent-%COMP%]{opacity:.8}@media (max-width: 900px){.hero[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.hero-side[_ngcontent-%COMP%]{align-items:flex-start}}.summary-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:12px}.summary-card[_ngcontent-%COMP%]{padding:10px 12px;border-radius:12px}.summary-label[_ngcontent-%COMP%]{font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;color:#9ca3af}.summary-value[_ngcontent-%COMP%]{margin-top:4px;font-size:1.2rem;font-weight:600;color:#111827}.summary-foot[_ngcontent-%COMP%]{margin-top:2px;font-size:.8rem;color:#6b7280}.modules-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.modules-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:600;color:#111827}.modules-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0 0;font-size:.85rem;color:#6b7280}.modules-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(270px,3fr));gap:14px}.module-card[_ngcontent-%COMP%]{padding:20px 20px 18px;border-radius:14px;cursor:pointer;display:flex;flex-direction:column;gap:8px;transition:transform .12s ease-out,box-shadow .12s ease-out,background .12s ease-out}.module-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 24px #0f172a1f;background:#f9fafb}.module-header[_ngcontent-%COMP%]{display:flex;gap:10px}.module-icon[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:#3b82f614;color:#1d4ed8}.module-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:.95rem;font-weight:600;color:#111827}.module-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0 0;font-size:.8rem;color:#6b7280}.module-subitems[_ngcontent-%COMP%]{margin-top:4px;display:flex;flex-wrap:wrap;gap:6px}.sub-chip[_ngcontent-%COMP%]{border:none;outline:none;padding:2px 10px;border-radius:999px;font-size:.75rem;background:#eef2ff;color:#4338ca;cursor:pointer}.sub-chip[_ngcontent-%COMP%]:hover{background:#e0e7ff}.module-footer[_ngcontent-%COMP%]{margin-top:4px;display:flex;align-items:center;justify-content:space-between;font-size:.8rem;color:#2563eb}.module-link[_ngcontent-%COMP%]{font-weight:500}.module-arrow[_ngcontent-%COMP%]{font-size:1.1rem}"]})};export{j as DashboardComponent};
