import{R as a,U as n,_ as i,uc as s}from"./chunk-JHWQBVSM.js";var p="/api/auth",l=class e{http=i(s);TOKEN_KEY="app.token";USER_KEY="app.user";login(t,o){return this.http.post(`${p}/login`,{email:t,password:o}).pipe(a(r=>{localStorage.setItem(this.TOKEN_KEY,r.accessToken),localStorage.setItem(this.USER_KEY,JSON.stringify(r.user)),localStorage.setItem("lastLogin",new Date().toISOString())}))}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY)}isLoggedIn(){return typeof localStorage>"u"?!1:!!localStorage.getItem(this.TOKEN_KEY)}getCurrentUser(){if(typeof localStorage>"u")return null;let t=localStorage.getItem(this.USER_KEY);return t?JSON.parse(t):null}forgotPassword(t){return this.http.post("/api/auth/forgot-password",{email:t})}static \u0275fac=function(o){return new(o||e)};static \u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})};export{l as a};
